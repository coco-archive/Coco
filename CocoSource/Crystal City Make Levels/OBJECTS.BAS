1 JMS F
5 PCLEAR 4
10 CLEAR 200,&H3FF0
15 DIM A(255):A=0:LA=0
16 READ A(A):IF A(A)<>0 THEN A=A+1:GOTO 16
20 INPUT"LEVEL";A$
30 LOADM"OBJECT "+A$
35 INPUT "INSERT CRYSTAL DISK, AND HIT    ENTER";Q$
39 Q=&H6001
40 FOR X=&H4000 TO &H6000 STEP 4
50 G=PEEK(X)*256+PEEK(X+1):IF G=&HFFFF THEN POKE Q,255:POKE Q+1,255:POKE Q+2,255:Q=Q+6:A=INT((Q-&H6000)/256):POKE &H6000,A:PRINT "$";HEX$(A);" SECTORS":SAVEM"OBJECT "+A$,&H6000,Q,0:INPUT A:POKE 113,0:DLOAD
60 G=INT(G/2)+14:Y=PEEK(X+2):A=A(PEEK(X+3)):IF A=0 THEN PRINT"ERROR":STOP
65 D=G-LA
70 IF (D<16)AND(Y<128) THEN PRINT"2";:POKE Q,A*8+(G-LA)/2:POKE Q+1,(D AND 1)*128+Y:Q=Q+2:GOTO 1010
80 IF (D<1024) THEN PRINT"3";:POKE Q,128+A*4+D/256:POKE Q+1,D AND 255:POKE Q+2,Y:Q=Q+3:GOTO 1010
90 PRINT"4";:POKE Q,192+A:B=INT(G/256):POKE Q+1,B:POKE Q+2,G-B*256:POKE Q+3,Y:Q=Q+4
1010 LA=G:NEXT X
1020 PRINT"NOT ENOUGH MEMORY":STOP
2000 DATA 1,2,5,4,6,7,8,9,10,11,12,13,14,15,0
