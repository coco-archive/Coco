20 CLEAR 200,&H5FF0:JMS F
25 INPUT"WHAT LEVEL";LV$
30 DIM S(90,1):SP=80:PP=0
40 POKE &HE6C6,&H21:HSCREEN 2
50 FORX=0TO320:IFERNO(X,0)=2THENSP=SP-1:S(SP,0)=X:S(SP,1)=1:HSET(X,0,0)
60 NEXT X
70 XX=S(SP,0):YY=S(SP,1):SP=SP+1:IFXX=0ANDYY=0THEN2000:ELSEIFERNO(XX,YY)=1THENGOSUB140
80 HSET(XX,YY,0):AA=ERNO(XX-1,YY):BB=ERNO(XX,YY+1):CC=ERNO(XX+1,YY):DD=ERNO(XX,YY-1)
90 IFAA=1ORAA=2THENSP=SP-1:S(SP,0)=XX-1:S(SP,1)=YY
100 IFBB=1ORBB=2THENSP=SP-1:S(SP,0)=XX:S(SP,1)=YY+1
110 IFCC=1ORCC=2THENSP=SP-1:S(SP,0)=XX+1:S(SP,1)=YY
120 IFDD=1ORDD=2THENSP=SP-1:S(SP,0)=XX:S(SP,1)=YY-1
130 GOTO 70
140 FORY=YY+1TOYY+16:FORX=XX+1TOXX+16STEP2:LPOKE PP,ERNO(X,Y)*16+ERNO(X+1,Y):HSET(X,Y,0):PP=PP+1:NEXTX,Y:RETURN
2000 POKE &HFFA3,0:SAVEM"BLOCKS"+LV$+".BIN",&H6000,&H7FFF,0
2010 POKE 113,0:DLOAD
